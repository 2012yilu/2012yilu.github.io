<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>推理挑战 - 完整多期版</title>
    <style>
        * {
            --primary-color: #1a73e8;
            --secondary-color: #ff4444;
            --success-color: #2ecc71;
            --border-radius: 15px;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Segoe UI", sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .header {
            color: var(--primary-color);
            font-size: 2.8rem;
            margin: 30px 0;
            text-shadow: 0 4px 12px rgba(26, 115, 232, 0.15);
        }

        .season-selector {
            margin-bottom: 30px;
            display: flex;
            gap: 15px;
        }

        .season-btn {
            padding: 10px 25px;
            background: white;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .season-btn.active {
            background: var(--primary-color);
            color: white;
            transform: scale(1.05);
        }

        .season-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .level-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 30px;
            width: 100%;
            max-width: 1000px;
        }

        .level-btn {
            width: 150px;
            height: 150px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .level-btn.locked {
            background: #f5f5f5;
            cursor: not-allowed;
            pointer-events: none;
            opacity: 0.6;
        }

        .level-btn.unlocked {
            color: var(--primary-color);
        }

        .level-btn.current {
            background: var(--primary-color);
            color: white;
            transform: scale(1.05);
        }

        .level-btn.completed::after {
            content: "✅";
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 1.2rem;
            color: var(--success-color);
        }

        .level-number {
            font-size: 3rem;
            font-weight: bold;
        }

        .question-section {
            display: none;
            width: 100%;
            max-width: 900px;
            background: white;
            padding: 35px;
            border-radius: var(--border-radius);
            box-shadow: 0 12px 36px rgba(0, 0, 0, 0.1);
            margin-top: 30px;
            line-height: 1.6;
        }

        .question-group {
            margin-bottom: 30px;
        }

        .question-title {
            font-size: 1.4rem;
            color: #333;
            margin-bottom: 15px;
        }

        .option {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.1rem;
            color: #5f6368;
            cursor: pointer;
            padding: 12px 20px;
            border-radius: 10px;
            transition: background-color 0.3s ease;
        }

        .option:hover {
            background: #f0f5fa;
        }

        input[type="radio"] {
            appearance: none;
            width: 24px;
            height: 24px;
            border: 2px solid var(--primary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        input[type="radio"]:checked {
            background: var(--primary-color);
        }

        input[type="radio"]::after {
            content: "";
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: white;
            display: none;
        }

        input[type="radio"]:checked::after {
            display: block;
        }

        .button-group {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 40px;
        }

        .back-btn,
        .submit-btn {
            padding: 14px 40px;
            border: none;
            border-radius: var(--border-radius);
            font-size: 1.2rem;
            cursor: pointer;
            transition: transform 0.3s ease;
            min-width: 180px;
        }

        .back-btn {
            background: var(--secondary-color);
            color: white;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.15);
        }

        .submit-btn {
            background: var(--primary-color);
            color: white;
            box-shadow: 0 4px 15px rgba(26, 115, 232, 0.2);
        }

        .back-btn:hover,
        .submit-btn:hover {
            transform: scale(1.05);
        }

        .help-tooltip {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: var(--primary-color);
            color: white;
            padding: 10px 18px;
            border-radius: 25px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: opacity 0.3s ease;
        }

        .help-tooltip:hover {
            opacity: 0.9;
        }

        .progress-info {
            color: #555;
            margin-bottom: 20px;
        }

        /* 弹窗样式 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: var(--border-radius);
            text-align: center;
            max-width: 600px;
        }

        /* 移动端适配 */
        @media (max-width: 600px) {
            .level-container {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .level-btn {
                width: 100%;
                height: 80px;
                flex-direction: row;
                justify-content: flex-start;
                padding-left: 20px;
            }

            .level-number {
                font-size: 1.8rem;
                margin-right: 15px;
            }
        }
    </style>
</head>

<body>
    <h1 class="header">推理挑战</h1>

    <div class="season-selector" id="seasonSelector"></div>
    <div class="progress-info" id="progressInfo"></div>
    <div class="level-container" id="levelContainer"></div>

    <div class="question-section" id="questionSection">
        <div id="questionContent"></div>
        <div class="button-group">
            <button class="back-btn" onclick="goBack()">返回关卡</button>
            <button class="submit-btn" onclick="checkAnswers()">提交答案</button>
        </div>
    </div>

    <div class="help-tooltip" onclick="showHelp()">?</div>

    <div class="modal" id="resultModal">
        <div class="modal-content">
            <h2 id="modalTitle"></h2>
            <div id="modalAnswers"></div>
            <button onclick="closeModal()">关闭</button>
        </div>
    </div>

    <script>
        // 完整游戏数据（三期，每期5关，每关3题）
        const gameData = {
            currentSeason: 1,
            currentLevel: 1,
            seasons: [
                {
                    title: "第一期：基础挑战",
                    levels: [
                        {
                            title: "逻辑入门",
                            questions: [
                                {
                                    q: "如果所有的鸟都会飞，企鹅是鸟，那么企鹅会飞吗？",
                                    options: ["A. 会", "B. 不会", "C. 可能", "D. 视情况而定"],
                                    answer: "B"
                                },
                                {
                                    q: "哪个图形与众不同？△ ○ □ △",
                                    options: ["A. △", "B. ○", "C. □", "D. 最后一个△"],
                                    answer: "B"
                                },
                                {
                                    q: "1+1在什么情况下不等于2？",
                                    options: ["A. 算错时", "B. 二进制", "C. 单位不同", "D. 所有情况"],
                                    answer: "B"
                                }
                            ]
                        },
                        {
                            title: "生活智慧",
                            questions: [
                                {
                                    q: "什么人从来不去医院？",
                                    options: ["A. 医生", "B. 死人", "C. 健康人", "D. 外星人"],
                                    answer: "B"
                                },
                                {
                                    q: "什么字横竖都能读？",
                                    options: ["A. 一", "B. 十", "C. 口", "D. 田"],
                                    answer: "B"
                                },
                                {
                                    q: "什么车不需要燃料？",
                                    options: ["A. 自行车", "B. 电车", "C. 太阳能车", "D. 玩具车"],
                                    answer: "A"
                                }
                            ]
                        },
                        {
                            title: "数字谜题",
                            questions: [
                                {
                                    q: "3人3天喝3桶水，9人9天喝几桶？",
                                    options: ["A. 9", "B. 18", "C. 27", "D. 81"],
                                    answer: "C"
                                },
                                {
                                    q: "下一个数字是？2, 3, 5, 8, 13",
                                    options: ["A. 18", "B. 20", "C. 21", "D. 24"],
                                    answer: "C"
                                },
                                {
                                    q: "1=5, 2=15, 3=215, 4=3215, 5=?",
                                    options: ["A. 43215", "B. 1", "C. 5215", "D. 53215"],
                                    answer: "B"
                                }
                            ]
                        },
                        {
                            title: "文字游戏",
                            questions: [
                                {
                                    q: "什么字人人都会念错？",
                                    options: ["A. 错", "B. 对", "C. 真", "D. 假"],
                                    answer: "A"
                                },
                                {
                                    q: "什么书不能看？",
                                    options: ["A. 天书", "B. 盲文书", "C. 遗嘱", "D. 无字书"],
                                    answer: "C"
                                },
                                {
                                    q: "什么牛不吃草？",
                                    options: ["A. 蜗牛", "B. 铁牛", "C. 天牛", "D. 奶牛"],
                                    answer: "A"
                                }
                            ]
                        },
                        {
                            title: "终极挑战",
                            questions: [
                                {
                                    q: "小华能在雨中站半小时全身湿透却不感冒，为什么？",
                                    options: ["A. 在浴室", "B. 是机器人", "C. 穿着雨衣", "D. 体质特殊"],
                                    answer: "A"
                                },
                                {
                                    q: "什么比赛要退着进行？",
                                    options: ["A. 拔河", "B. 赛跑", "C. 游泳", "D. 跳远"],
                                    answer: "A"
                                },
                                {
                                    q: "什么门永远关不上？",
                                    options: ["A. 球门", "B. 心门", "C. 电梯门", "D. 冰箱门"],
                                    answer: "A"
                                }
                            ]
                        }
                    ]
                },
                {
                    title: "第二期：进阶挑战",
                    levels: [
                        {
                            title: "逻辑进阶",
                            questions: [
                                {
                                    q: "如果所有A都是B，有些B是C，那么：",
                                    options: ["A. 有些A是C", "B. 所有A是C", "C. 无法确定", "D. 没有A是C"],
                                    answer: "C"
                                },
                                {
                                    q: "甲乙丙丁谁是小偷？(只有1人说真话)\n甲：不是我\n乙：是丙\n丙：是乙\n丁：不是我",
                                    options: ["A. 甲", "B. 乙", "C. 丙", "D. 丁"],
                                    answer: "A"
                                },
                                {
                                    q: "下一个图形是？□ ○ △ □ ○",
                                    options: ["A. △", "B. □", "C. ○", "D. ☆"],
                                    answer: "A"
                                }
                            ]
                        },
                        {
                            title: "空间想象",
                            questions: [
                                {
                                    q: "立方体展开图哪个不能组成正方体？",
                                    options: ["A. 田字形", "B. 楼梯形", "C. L字形", "D. T字形"],
                                    answer: "D"
                                },
                                {
                                    q: "最少需要几根火柴摆3个三角形？",
                                    options: ["A. 6", "B. 7", "C. 9", "D. 12"],
                                    answer: "A"
                                },
                                {
                                    q: "镜子里的电子钟显示15:20，实际时间是？",
                                    options: ["A. 15:20", "B. 20:15", "C. 21:50", "D. 12:50"],
                                    answer: "C"
                                }
                            ]
                        },
                        {
                            title: "数学思维",
                            questions: [
                                {
                                    q: "3个苹果分给5人，至少要切几刀？",
                                    options: ["A. 3", "B. 4", "C. 5", "D. 6"],
                                    answer: "B"
                                },
                                {
                                    q: "时针分针一昼夜重合几次？",
                                    options: ["A. 22", "B. 23", "C. 24", "D. 25"],
                                    answer: "A"
                                },
                                {
                                    q: "100!末尾有几个0？",
                                    options: ["A. 20", "B. 24", "C. 21", "D. 25"],
                                    answer: "B"
                                }
                            ]
                        },
                        {
                            title: "生活观察",
                            questions: [
                                {
                                    q: "什么医院不治病？",
                                    options: ["A. 宠物医院", "B. 手机医院", "C. 植物医院", "D. 心理医院"],
                                    answer: "B"
                                },
                                {
                                    q: "什么照片看不出人？",
                                    options: ["A. X光片", "B. 背影照", "C. 婴儿照", "D. 证件照"],
                                    answer: "A"
                                },
                                {
                                    q: "什么蛋不能吃？",
                                    options: ["A. 笨蛋", "B. 鸡蛋", "C. 鸭蛋", "D. 鹅蛋"],
                                    answer: "A"
                                }
                            ]
                        },
                        {
                            title: "终极挑战",
                            questions: [
                                {
                                    q: "小明知道答案却总答错，为什么？",
                                    options: ["A. 文盲", "B. 考卷印错", "C. 被威胁", "D. 在改错题"],
                                    answer: "D"
                                },
                                {
                                    q: "什么比赛赢的得不到，输的才有？",
                                    options: ["A. 划拳", "B. 猜拳", "C. 拔河", "D. 下棋"],
                                    answer: "C"
                                },
                                {
                                    q: "怎样让10+10=100？",
                                    options: ["A. 算错", "B. 二进制", "C. 单位米+厘米", "D. 镜子反射"],
                                    answer: "B"
                                }
                            ]
                        }
                    ]
                },
                {
                    title: "第三期：大师试炼",
                    levels: [
                        {
                            title: "逻辑大师",
                            questions: [
                                {
                                    q: "甲说乙说谎，乙说丙说谎，丙说甲乙都说谎，谁说谎？",
                                    options: ["A. 甲", "B. 乙", "C. 丙", "D. 全部"],
                                    answer: "C"
                                },
                                {
                                    q: "A＞B，B＞C，C＞A可能吗？",
                                    options: ["A. 不可能", "B. 循环定义", "C. 不同标准", "D. 可能"],
                                    answer: "C"
                                },
                                {
                                    q: "下一个字母是？O, T, T, F, F",
                                    options: ["A. S", "B. S", "C. E", "D. N"],
                                    answer: "A"
                                }
                            ]
                        },
                        {
                            title: "空间大师",
                            questions: [
                                {
                                    q: "立方体三个相邻面中心连线形成的三角形是？",
                                    options: ["A. 等边", "B. 等腰", "C. 直角", "D. 不规则"],
                                    answer: "A"
                                },
                                {
                                    q: "将正方形沿对角线折叠后有几个直角？",
                                    options: ["A. 2", "B. 4", "C. 6", "D. 8"],
                                    answer: "B"
                                },
                                {
                                    q: "正方体切去一个角还剩几个角？",
                                    options: ["A. 7", "B. 10", "C. 12", "D. 14"],
                                    answer: "B"
                                }
                            ]
                        },
                        {
                            title: "数学大师",
                            questions: [
                                {
                                    q: "1~100去掉所有含4的数还剩几个？",
                                    options: ["A. 72", "B. 80", "C. 81", "D. 90"],
                                    answer: "C"
                                },
                                {
                                    q: "3个人3顶帽子，至少1人拿到自己帽子的概率是？",
                                    options: ["A. 1/3", "B. 1/2", "C. 2/3", "D. 5/6"],
                                    answer: "C"
                                },
                                {
                                    q: "1元买3个桃，3个核换1个桃，10元最多吃几个？",
                                    options: ["A. 40", "B. 44", "C. 45", "D. 50"],
                                    answer: "C"
                                }
                            ]
                        },
                        {
                            title: "观察大师",
                            questions: [
                                {
                                    q: "下图中有几个三角形？（模拟题）",
                                    options: ["A. 5", "B. 8", "C. 10", "D. 12"],
                                    answer: "C"
                                },
                                {
                                    q: "哪个月有28天？",
                                    options: ["A. 2月", "B. 闰年2月", "C. 每个月", "D. 没有"],
                                    answer: "C"
                                },
                                {
                                    q: "什么动物天天熬夜？",
                                    options: ["A. 猫头鹰", "B. 熊猫", "C. 蝙蝠", "D. 没有"],
                                    answer: "B"
                                }
                            ]
                        },
                        {
                            title: "终极试炼",
                            questions: [
                                {
                                    q: "小张开车见红灯不停却合法，为什么？",
                                    options: ["A. 色盲", "B. 开火车", "C. 警车", "D. 没开车"],
                                    answer: "B"
                                },
                                {
                                    q: "怎样用红蓝铅笔写出黑字？",
                                    options: ["A. 不可能", "B. 写'黑'字", "C. 混合颜色", "D. 刻字"],
                                    answer: "B"
                                },
                                {
                                    q: "什么池不能装水？",
                                    options: ["A. 电池", "B. 泳池", "C. 浴池", "D. 池塘"],
                                    answer: "A"
                                }
                            ]
                        }
                    ]
                }
            ],
            unlockedLevels: {
                1: 1,
                2: 0,
                3: 0
            }
        };

        // 初始化游戏
        function initGame() {
            try {
                const savedData = localStorage.getItem("推理游戏进度");
                if (savedData) {
                    const progress = JSON.parse(savedData);
                    gameData.currentSeason = progress.currentSeason || 1;
                    gameData.unlockedLevels = progress.unlockedLevels || { 1: 1, 2: 0, 3: 0 };
                }
                renderSeasonSelector();
                updateProgress();
                renderLevels();
            } catch (error) {
                console.error("初始化错误:", error);
                localStorage.removeItem("推理游戏进度");
                gameData.unlockedLevels = { 1: 1, 2: 0, 3: 0 };
            }
        }

        // 渲染季选择器
        function renderSeasonSelector() {
            const container = document.getElementById("seasonSelector");
            container.innerHTML = "";

            gameData.seasons.forEach((season, index) => {
                const btn = document.createElement("button");
                btn.className = `season-btn ${index + 1 === gameData.currentSeason ? 'active' : ''}`;
                btn.textContent = season.title;

                // 判断赛季是否解锁
                if (index > 0 && gameData.unlockedLevels[index] < gameData.seasons[index - 1].levels.length) {
                    btn.disabled = true;
                    btn.title = "需要先完成前一季";
                }

                btn.onclick = () => {
                    gameData.currentSeason = index + 1;
                    renderSeasonSelector();
                    updateProgress();
                    renderLevels();
                };
                container.appendChild(btn);
            });
        }

        // 完整渲染关卡逻辑
        function renderLevels() {
            const container = document.getElementById("levelContainer");
            container.innerHTML = "";

            const season = gameData.seasons[gameData.currentSeason - 1];
            const seasonProgress = gameData.unlockedLevels[gameData.currentSeason];

            season.levels.forEach((level, index) => {
                const btn = document.createElement("div");
                let status = "locked";

                if (index < seasonProgress) {
                    status = "completed";
                } else if (index === seasonProgress) {
                    status = "current";
                }

                btn.className = `level-btn ${status}`;
                btn.innerHTML = `
                    <div class="level-number">${index + 1}</div>
                    <div class="level-status">${level.title}</div>
                `;

                if (status !== "locked") {
                    btn.onclick = () => {
                        gameData.currentLevel = index + 1;
                        showQuestions();
                    };
                }

                container.appendChild(btn);
            });
        }

        // 显示题目完整逻辑
        function showQuestions() {
            const season = gameData.seasons[gameData.currentSeason - 1];
            const level = season.levels[gameData.currentLevel - 1];

            document.getElementById("questionContent").innerHTML = `
                <h3>${season.title} - ${level.title}</h3>
                ${level.questions.map((q, i) => `
                    <div class="question-group">
                        <div class="question-title">${i + 1}. ${q.q}</div>
                        <div class="option-group">
                            ${q.options.map(opt => `
                                <div class="option">
                                    <input type="radio" name="q${i}" value="${opt.charAt(0)}">
                                    <label>${opt}</label>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `).join('')}
            `;

            document.getElementById("questionSection").style.display = "block";
            document.getElementById("levelContainer").style.display = "none";
        }

        // 完整答案检查逻辑
        function checkAnswers() {
            const season = gameData.seasons[gameData.currentSeason - 1];
            const level = season.levels[gameData.currentLevel - 1];
            let allCorrect = true;
            const results = [];

            level.questions.forEach((q, i) => {
                const selected = document.querySelector(`input[name="q${i}"]:checked`);
                const isCorrect = selected && selected.value === q.answer;
                results.push({ isCorrect, question: q, selected: selected?.value });
                if (!isCorrect) {
                    allCorrect = false;
                }
            });

            showResultModal(allCorrect, results);

            if (allCorrect) {
                const seasonProgress = gameData.unlockedLevels[gameData.currentSeason];

                // 更新当前关卡进度
                if (gameData.currentLevel === seasonProgress) {
                    gameData.unlockedLevels[gameData.currentSeason]++;

                    // 判断是否完成本季
                    if (gameData.unlockedLevels[gameData.currentSeason] > season.levels.length) {
                        if (gameData.currentSeason < gameData.seasons.length) {
                            gameData.unlockedLevels[gameData.currentSeason + 1] = 1;
                        }
                        showResultModal(true, results, "🎉 恭喜完成本季所有挑战！");
                    }
                }

                // 保存进度
                localStorage.setItem("推理游戏进度", JSON.stringify({
                    currentSeason: gameData.currentSeason,
                    unlockedLevels: gameData.unlockedLevels
                }));

                renderLevels();
                updateProgress();
                goBack();
            }
        }

        // 显示结果弹窗
        function showResultModal(isCorrect, results, message = "") {
            const modal = document.getElementById("resultModal");
            modal.style.display = "flex";

            const title = isCorrect ? "🎉 回答正确！" : "❌ 部分答案错误";
            document.getElementById("modalTitle").textContent = title;

            const answersHtml = results.map((result, i) => `
                <div class="result-item ${result.isCorrect ? 'correct' : 'incorrect'}">
                    <span>${i + 1}. ${result.question.q}</span>
                    <span>你的答案：${result.selected || "未选择"}</span>
                    <span>正确答案：${result.question.answer}</span>
                </div>
            `).join('');

            document.getElementById("modalAnswers").innerHTML = answersHtml + (message ? `<p>${message}</p>` : '');
        }

        // 关闭结果弹窗
        function closeModal() {
            document.getElementById("resultModal").style.display = "none";
        }

        // 其他辅助函数
        function goBack() {
            document.getElementById("questionSection").style.display = "none";
            document.getElementById("levelContainer").style.display = "grid";
        }

        function updateProgress() {
            const seasonProgress = gameData.unlockedLevels[gameData.currentSeason];
            const info = `当前进度：第${gameData.currentSeason}季 - 已通过${seasonProgress - 1}关`;
            document.getElementById("progressInfo").textContent = info;
        }

        function showHelp() {
            alert("🎮 游戏指南：\n1. 每季5个关卡\n2. 每个关卡需答对全部3题\n3. 完成当前季解锁下一季\n4. 进度自动保存\n5. 点击帮助按钮查看提示");
        }

        // 启动游戏
        window.onload = initGame;
    </script>
</body>

</html>    

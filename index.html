<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" rel="stylesheet">
    <title>推理题</title>
    <style>
        /* 平滑滚动效果 */
        html {
            scroll-behavior: smooth;
        }

        /* 悬停动画效果 */
        .hover-scale:hover {
            transform: scale(1.05);
            transition: transform 0.3s ease;
        }

        /* 答对和答错结果样式 */
        .correct-answer {
            color: green;
            font-weight: bold;
        }

        .wrong-answer {
            color: red;
            font-weight: bold;
        }

        /* 结果弹窗样式 */
        .result-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
        }

        .result-modal-content {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
            width: 80%;
            max-width: 600px;
        }

        /* 五彩商标样式 */
        .rainbow-text {
            background-image: linear-gradient(to right, red, orange, yellow, green, blue);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-size: 2rem;
            font-weight: bold;
        }
    </style>
</head>

<body class="bg-gray-100 font-sans">
    <!-- 导航栏 -->
    <nav class="bg-white shadow-md p-4 flex justify-between items-center">
        <h1 class="rainbow-text">推理题</h1>
        <input type="text" id="search-input" placeholder="搜索往期题目" class="border border-gray-300 rounded p-2">
        <button id="search-button" class="bg-blue-500 text-white p-2 rounded ml-2" onclick="searchPeriods()">搜索</button>
    </nav>

    <!-- 首页内容 -->
    <div id="home" class="p-8">
        <!-- 最新3期显示 -->
        <div id="latest-periods" class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <!-- 期内容将通过 JavaScript 动态添加 -->
        </div>

        <!-- 玩法介绍和关于声明 -->
        <div class="grid grid-cols-2 gap-4 mt-8">
            <div class="bg-white p-6 rounded shadow-md hover-scale cursor-pointer" onclick="showPlayMethod()">
                <h3 class="text-lg font-bold">玩法介绍</h3>
            </div>
            <div class="bg-white p-6 rounded shadow-md hover-scale cursor-pointer" onclick="showAbout()">
                <h3 class="text-lg font-bold">关于和声明</h3>
            </div>
        </div>

        <!-- 显示所有期按钮 -->
        <button class="bg-blue-500 text-white p-2 rounded mt-8" onclick="showAllPeriods()">显示所有期</button>
    </div>

    <!-- 详细页内容 -->
    <div id="detail" class="p-8 hidden">
        <!-- 题目显示 -->
        <div id="question-container" class="bg-white p-6 rounded shadow-md mb-8">
            <!-- 题目将通过 JavaScript 动态添加 -->
        </div>
        <!-- 提交答案按钮 -->
        <button class="bg-green-500 text-white p-2 rounded" onclick="checkAnswers()">提交答案</button>
        <!-- 结果显示 -->
        <div id="result" class="mt-4 hidden">
            <!-- 结果将通过 JavaScript 动态添加 -->
        </div>
    </div>

    <!-- 所有期列表 -->
    <div id="all-periods" class="p-8 hidden">
        <!-- 期列表将通过 JavaScript 动态添加 -->
        <div class="flex justify-between mt-4">
            <button class="bg-gray-300 p-2 rounded" onclick="prevPage()">上一页</button>
            <button class="bg-gray-300 p-2 rounded" onclick="nextPage()">下一页</button>
        </div>
    </div>

    <!-- 玩法介绍模态框 -->
    <div id="play-method-modal" class="fixed top-0 left-0 w-full h-full bg-black bg-opacity-50 hidden justify-center items-center">
        <div class="bg-white p-8 rounded shadow-md">
            <h2 class="text-2xl font-bold mb-4">玩法介绍</h2>
            <p>每一期有最多5道推理题，包含填空和选择题。你需要在输入框或选项中选择你的答案，然后点击提交答案，系统会显示你答对和答错的题目。</p>
            <button class="bg-gray-300 p-2 rounded mt-4" onclick="closePlayMethod()">关闭</button>
        </div>
    </div>

    <!-- 关于和声明模态框 -->
    <div id="about-modal" class="fixed top-0 left-0 w-full h-full bg-black bg-opacity-50 hidden justify-center items-center">
        <div class="bg-white p-8 rounded shadow-md">
            <h2 class="text-2xl font-bold mb-4">关于和声明</h2>
            <p>本网站的推理题仅供娱乐，版权归开发者所有。</p>
            <button class="bg-gray-300 p-2 rounded mt-4" onclick="closeAbout()">关闭</button>
        </div>
    </div>

    <!-- 结果弹窗 -->
    <div id="result-modal" class="result-modal">
        <div class="result-modal-content">
            <h2 id="result-modal-title" class="text-2xl font-bold mb-4"></h2>
            <div id="result-modal-body"></div>
            <button class="bg-gray-300 p-2 rounded mt-4" onclick="closeResultModal()">关闭</button>
        </div>
    </div>

    <script>
        // 模拟数据库数据，增加了解析字段
        const database = {
            "1": {
                "title": "第1期",
                "description": "这是第1期推理题的简介，快来挑战吧！",
                "questions": [
                    {
                        "type": "fill",
                        "question": "1 + 1 = __",
                        "answer": "2",
                        "explanation": "1加1的和是2，这是基本的数学运算。"
                    },
                    {
                        "type": "choice",
                        "question": "以下哪个是水果？",
                        "options": ["苹果", "汽车", "桌子"],
                        "answer": "苹果",
                        "explanation": "苹果是水果，而汽车和桌子分别属于交通工具和家具类别。"
                    }
                ]
            },
            "2": {
                "title": "第2期",
                "description": "这是第2期推理题的简介，快来挑战吧！",
                "questions": [
                    {
                        "type": "fill",
                        "question": "2 + 2 = __",
                        "answer": "4",
                        "explanation": "2加2的和是4，属于简单的加法运算。"
                    },
                    {
                        "type": "choice",
                        "question": "以下哪个是动物？",
                        "options": ["猫", "椅子", "杯子"],
                        "answer": "猫",
                        "explanation": "猫是动物，椅子和杯子是生活用品。"
                    }
                ]
            },
            "3": {
                "title": "第3期",
                "description": "这是第3期推理题的简介，快来挑战吧！",
                "questions": [
                    {
                        "type": "fill",
                        "question": "3 + 3 = __",
                        "answer": "6",
                        "explanation": "3加3等于6，是基础的数学加法。"
                    },
                    {
                        "type": "choice",
                        "question": "以下哪个是交通工具？",
                        "options": ["自行车", "书本", "电视"],
                        "answer": "自行车",
                        "explanation": "自行车是常见的交通工具，书本用于阅读，电视是家电。"
                    }
                ]
            },
            "4": {
                "title": "第4期",
                "description": "这是第4期推理题的简介，快来挑战吧！",
                "questions": [
                    {
                        "type": "fill",
                        "question": "4 + 4 = __",
                        "answer": "8",
                        "explanation": "4加4的结果是8，属于简单加法运算。"
                    },
                    {
                        "type": "choice",
                        "question": "以下哪个是蔬菜？",
                        "options": ["胡萝卜", "手机", "鞋子"],
                        "answer": "胡萝卜",
                        "explanation": "胡萝卜是蔬菜，手机和鞋子分别是电子产品和服饰用品。"
                    }
                ]
            }
        };

        const periods = Object.keys(database);
        let currentPage = 1;
        const itemsPerPage = 5;
        let currentPeriodId;

        // 显示玩法介绍
        function showPlayMethod() {
            document.getElementById('play-method-modal').classList.remove('hidden');
        }

        // 关闭玩法介绍
        function closePlayMethod() {
            document.getElementById('play-method-modal').classList.add('hidden');
        }

        // 显示关于和声明
        function showAbout() {
            document.getElementById('about-modal').classList.remove('hidden');
        }

        // 关闭关于和声明
        function closeAbout() {
            document.getElementById('about-modal').classList.add('hidden');
        }

        // 显示所有期
        function showAllPeriods() {
            document.getElementById('home').classList.add('hidden');
            document.getElementById('detail').classList.add('hidden');
            document.getElementById('all-periods').classList.remove('hidden');

            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const currentPeriods = periods.slice(startIndex, endIndex);

            const periodList = document.createElement('div');
            currentPeriods.forEach(period => {
                const periodDiv = document.createElement('div');
                periodDiv.classList.add('bg-white', 'p-6', 'rounded', 'shadow-md', 'mb-4', 'hover-scale', 'cursor-pointer');
                periodDiv.textContent = database[period].title;
                periodDiv.onclick = () => showDetail(period);
                periodList.appendChild(periodDiv);
            });

            const allPeriodsContainer = document.getElementById('all-periods');
            allPeriodsContainer.innerHTML = '';
            allPeriodsContainer.appendChild(periodList);

            const pagination = document.createElement('div');
            pagination.classList.add('flex', 'justify-between', 'mt-4');
            const prevButton = document.createElement('button');
            prevButton.classList.add('bg-gray-300', 'p-2', 'rounded');
            prevButton.textContent = '上一页';
            prevButton.onclick = prevPage;
            const nextButton = document.createElement('button');
            nextButton.classList.add('bg-gray-300', 'p-2', 'rounded');
            nextButton.textContent = '下一页';
            nextButton.onclick = nextPage;
            pagination.appendChild(prevButton);
            pagination.appendChild(nextButton);
            allPeriodsContainer.appendChild(pagination);
        }

        // 上一页
        function prevPage() {
            if (currentPage > 1) {
                currentPage--;
                showAllPeriods();
            }
        }

        // 下一页
        function nextPage() {
            const totalPages = Math.ceil(periods.length / itemsPerPage);
            if (currentPage < totalPages) {
                currentPage++;
                showAllPeriods();
            }
        }

        // 显示详细页
        function showDetail(period) {
            currentPeriodId = period;
            document.getElementById('home').classList.add('hidden');
            document.getElementById('all-periods').classList.add('hidden');
            document.getElementById('detail').classList.remove('hidden');

            const questionContainer = document.getElementById('question-container');
            questionContainer.innerHTML = `<h2 class="text-2xl font-bold mb-4">${database[period].title}</h2>`;

            database[period].questions.forEach((question, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.classList.add('mb-4');
                questionDiv.innerHTML = `<p class="text-lg font-bold">${index + 1}. ${question.question}</p>`;

                if (question.type === 'fill') {
                    const input = document.createElement('input');
                    input.type = 'text';
                    input.id = `question-${index}`;
                    questionDiv.appendChild(input);
                } else if (question.type === 'choice') {
                    question.options.forEach(option => {
                        const label = document.createElement('label');
                        label.classList.add('block', 'mb-1');
                        const radio = document.createElement('input');
                        radio.type = 'radio';
                        radio.name = `question-${index}`;
                        radio.value = option;
                        label.appendChild(radio);
                        label.appendChild(document.createTextNode(option));
                        questionDiv.appendChild(label);
                    });
                }

                questionContainer.appendChild(questionDiv);
            });
        }

        // 检查答案
        function checkAnswers() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '';
            resultDiv.classList.remove('hidden');

            const currentPeriod = database[currentPeriodId];
            const correctAnswers = [];
            const wrongAnswers = [];

            currentPeriod.questions.forEach((question, index) => {
                let userAnswer;
                if (question.type === 'fill') {
                    userAnswer = document.getElementById(`question-${index}`).value;
                } else if (question.type === 'choice') {
                    const radios = document.querySelectorAll(`input[name="question-${index}"]`);
                    radios.forEach(radio => {
                        if (radio.checked) {
                            userAnswer = radio.value;
                        }
                    });
                }

                const isCorrect = userAnswer === question.answer;
                const resultText = isCorrect ? '答对了' : '答错了';
                const resultP = document.createElement('p');
                resultP.textContent = `${index + 1}. ${resultText}`;
                if (isCorrect) {
                    resultP.classList.add('correct-answer');
                    correctAnswers.push({ question: question.question, index: index + 1 });
                } else {
                    resultP.classList.add('wrong-answer');
                    wrongAnswers.push({ question: question.question, index: index + 1, explanation: question.explanation });
                }
                resultDiv.appendChild(resultP);
            });

            showResultModal(correctAnswers, wrongAnswers);
        }

        // 显示结果弹窗
        function showResultModal(correctAnswers, wrongAnswers) {
            const resultModal = document.getElementById('result-modal');
            const resultModalTitle = document.getElementById('result-modal-title');
            const resultModalBody = document.getElementById('result-modal-body');

            resultModalBody.innerHTML = '';

            if (correctAnswers.length > 0) {
                resultModalTitle.textContent = '恭喜你，以下题目答对啦！';
                correctAnswers.forEach(item => {
                    const p = document.createElement('p');
                    p.textContent = `${item.index}. ${item.question} - 答对啦，你真棒！`;
                    p.classList.add('correct-answer');
                    resultModalBody.appendChild(p);
                });
            }

            if (wrongAnswers.length > 0) {
                if (correctAnswers.length > 0) {
                    const separator = document.createElement('hr');
                    resultModalBody.appendChild(separator);
                }
                resultModalTitle.textContent = '部分题目答错啦，看看解析吧！';
                wrongAnswers.forEach(item => {
                    const p = document.createElement('p');
                    p.textContent = `${item.index}. ${item.question} - 答错了，解析：${item.explanation}`;
                    p.classList.add('wrong-answer');
                    resultModalBody.appendChild(p);
                });
            }

            resultModal.style.display = 'flex';
        }

        // 关闭结果弹窗
        function closeResultModal() {
            const resultModal = document.getElementById('result-modal');
            resultModal.style.display = 'none';
        }

        // 搜索期
        function searchPeriods() {
            const searchInput = document.getElementById('search-input').value.toLowerCase();
            const filteredPeriods = periods.filter(period => {
                const title = database[period].title.toLowerCase();
                const description = database[period].description.toLowerCase();
                const hasMatchInQuestions = database[period].questions.some(q => {
                    const questionText = q.question.toLowerCase();
                    return questionText.includes(searchInput);
                });
                return title.includes(searchInput) || description.includes(searchInput) || hasMatchInQuestions;
            });

            document.getElementById('home').classList.add('hidden');
            document.getElementById('detail').classList.add('hidden');
            document.getElementById('all-periods').classList.remove('hidden');

            const periodList = document.createElement('div');
            filteredPeriods.forEach(period => {
                const periodDiv = document.createElement('div');
                periodDiv.classList.add('bg-white', 'p-6', 'rounded', 'shadow-md', 'mb-4', 'hover-scale', 'cursor-pointer');
                periodDiv.textContent = database[period].title;
                periodDiv.onclick = () => showDetail(period);
                periodList.appendChild(periodDiv);
            });

            const allPeriodsContainer = document.getElementById('all-periods');
            allPeriodsContainer.innerHTML = '';
            allPeriodsContainer.appendChild(periodList);

            const pagination = document.createElement('div');
            pagination.classList.add('flex', 'justify-between', 'mt-4');
            const prevButton = document.createElement('button');
            prevButton.classList.add('bg-gray-300', 'p-2', 'rounded');
            prevButton.textContent = '上一页';
            prevButton.onclick = prevPage;
            const nextButton = document.createElement('button');
            nextButton.classList.add('bg-gray-300', 'p-2', 'rounded');
            nextButton.textContent = '下一页';
            nextButton.onclick = nextPage;
            pagination.appendChild(prevButton);
            pagination.appendChild(nextButton);
            allPeriodsContainer.appendChild(pagination);
        }

        // 初始化首页显示最新3期
        function initHome() {
            const latestPeriods = periods.slice(0, 3);
            const latestPeriodsContainer = document.getElementById('latest-periods');
            latestPeriods.forEach(period => {
                const periodDiv = document.createElement('div');
                periodDiv.classList.add('bg-white', 'p-6', 'rounded', 'shadow-md', 'hover-scale', 'cursor-pointer');
                periodDiv.innerHTML = `<h2 class="text-2xl font-bold mb-2">最新！new ${database[period].title}</h2><p class="text-gray-600">${database[period].description}</p>`;
                periodDiv.onclick = () => showDetail(period);
                latestPeriodsContainer.appendChild(periodDiv);
            });
        }

        // 页面加载时初始化首页
        window.onload = initHome;
    </script>
</body>

</html>    
